#The correlation matrices for unbinned 3pi all true fit  

from numpy import array
import numpy as np
import uncertainties
from uncertainties import *


#3pi all true 5

val1={'I9': (1.0326646471270351e-07, 0.017157604203728694), 'I8': (-4.27737426589303e-08, 0.016997109462063065), 'I6c': (0.3616235141622446, 0.028887582943266432), 'I3': (-0.10332103144144655, 0.02404893594908497), 'I2s': (0.06457575059506793, 0.013763635107599925), 'I4': (-0.1365313701940487, 0.02430029471514289), 'I7': (-2.0492974339703096e-07, 0.015314046791704228), 'loglh': -518.4112350753132, 'status': 3, 'I1s': (0.3763838261090342, 0.030554763024308706), 'iterations': 276, 'I6s': (-0.2546126760989651, 0.02298326889848018), 'I2c': (-0.16420663579962236, 0.03918263578362252), 'I1c': (0.5590404502957198, 0.04465135098148654)}
mat1=np.array([
[1.000 ,-0.047  ,0.292, -0.367  ,0.217  ,0.236 ,-0.048,  0.226 ,-0.335 ,-0.339 , 0.072],
[-0.047 , 1.000 ,-0.038, -0.062 ,-0.089 ,-0.105, -0.041, -0.139 , 0.041 ,-0.047,  0.045],
[0.292 ,-0.038  ,1.000 ,-0.670  ,0.684  ,0.629 ,-0.084 , 0.667 ,-0.819 ,-0.736 , 0.489],
[-0.367 ,-0.062 ,-0.670 , 1.000 ,-0.494 ,-0.545 , 0.008 ,-0.550 , 0.556 , 0.519, -0.462],
[0.217 ,-0.089  ,0.684 ,-0.494  ,1.000  ,0.633 ,-0.008  ,0.603 ,-0.797 ,-0.824 , 0.499],
[0.236 ,-0.105  ,0.629 ,-0.545  ,0.633  ,1.000 , 0.158  ,0.564 ,-0.785 ,-0.798 , 0.462],
[-0.048 ,-0.041 ,-0.084,  0.008 ,-0.008 , 0.158 , 1.000 ,-0.217 , 0.069 ,-0.157,  0.097],
[0.226 ,-0.139  ,0.667 ,-0.550 , 0.603  ,0.564 ,-0.217  ,1.000 ,-0.793 ,-0.691 , 0.403],
[-0.335 , 0.041 ,-0.819 , 0.556, -0.797 ,-0.785 , 0.069 ,-0.793 , 1.000 , 0.848, -0.588],
[-0.339 ,-0.047 ,-0.736 , 0.519, -0.824 ,-0.798 ,-0.157 ,-0.691 , 0.848 , 1.000, -0.631],
[0.072  ,0.045 , 0.489 ,-0.462 , 0.499  ,0.462 , 0.097  ,0.403 ,-0.588 ,-0.631 , 1.000]
])

                                                               
I9=val1['I9']
I8=val1['I8']
I7=val1['I7']
I6s=val1['I6s']
I6c=val1['I6c']
I5=val1['I5']
I4=val1['I4']
I3=val1['I3']
I2s=val1['I2s']
I2c=val1['I2c']
I1s=val1['I1s']
I1c=val1['I1c']

(I8,I7,I6s,I6c,I4,I3,I2s,I2c,I1s,I1c,I9)= correlated_values_norm([I8,I7,I6s,I6c,I4,I3,I2s,I2c,I1s,I1c,I9], mat1)
1-I8-I7-I9-I4-I3-I2s-I2c-I1c-I1s-I6c-I6s
0.29704831680903765+/-0.022803505485894052



val1={'I9': (0.0054572498514628975, 0.009954280128435189), 'I8': (0.0024101834301109015, 0.010821197024770135), 'I6c': (0.3394858377624037, 0.013910708192177323), 'I3': (-0.06801607723828607, 0.009440836501850514), 'I2s': (0.09444422515477724, 0.010303689174199326), 'I4': (-0.12579163920452263, 0.011837036132536505), 'I7': (-0.059305834387354595, 0.010543310688310381), 'loglh': -1177.1458783138505, 'status': 3, 'I1s': (0.3946398981436079, 0.015298876452449983), 'iterations': 310, 'I6s': (-0.27482308982364967, 0.01420254203715815), 'I2c': (-0.166456053759797, 0.01832810032324428), 'I1c': (0.5313612928056983, 0.016759857630193165)}
mat1=np.array([
[1.000 , 0.021  ,0.179 ,-0.212  ,0.111  ,0.083 ,-0.097 , 0.063 ,-0.227, -0.279 ,-0.123],
[0.021 , 1.000  ,0.374 ,-0.351  ,0.283  ,0.236 ,-0.166  ,0.261 ,-0.476 ,-0.522  ,0.193],
[0.179  ,0.374  ,1.000 ,-0.444  ,0.586  ,0.372 ,-0.365  ,0.487 ,-0.770 ,-0.647  ,0.188],
[-0.212 ,-0.351 ,-0.444 , 1.000 ,-0.277 ,-0.344, -0.060 ,-0.052 , 0.212 , 0.330 ,-0.272],
[0.111  ,0.283  ,0.586 ,-0.277  ,1.000  ,0.286 ,-0.292 , 0.388 ,-0.644 ,-0.674  ,0.076],
[0.083  ,0.236  ,0.372 ,-0.344  ,0.286  ,1.000 ,-0.062 , 0.250 ,-0.515 ,-0.543  ,0.024],
[-0.097 ,-0.166 ,-0.365 ,-0.060 ,-0.292 ,-0.062 , 1.000 ,-0.479 , 0.455 , 0.152 ,-0.056],
[0.063  ,0.261  ,0.487 ,-0.052  ,0.388  ,0.250 ,-0.479  ,1.000 ,-0.677 ,-0.569  ,0.040],
[-0.227 ,-0.476 ,-0.770 , 0.212 ,-0.644 ,-0.515 , 0.455 ,-0.677 , 1.000 , 0.708 ,-0.209],
[-0.279 ,-0.522, -0.647 , 0.330 ,-0.674 ,-0.543 , 0.152 ,-0.569  ,0.708 , 1.000 ,-0.249],
[-0.123 , 0.193 , 0.188 ,-0.272 , 0.076 , 0.024 ,-0.056 , 0.040 ,-0.209 ,-0.249 , 1.000]
])

0.3265940072655489+/-0.014444372922618806


val1={'I9': (0.01732842106248844, 0.0065572873197826675), 'I8': (0.010063574503366146, 0.007237709388416946), 'I6c': (0.31747712610990986, 0.010716364833680436), 'I3': (-0.09195041455765285, 0.008120481484281405), 'I2s': (0.07199810082673097, 0.007088354398529062), 'I4': (-0.15906226904243703, 0.008819264889459444), 'I7': (0.03432362669031619, 0.006710484707168063), 'loglh': -2280.830322368373, 'status': 3, 'I1s': (0.3891181082536872, 0.010923888427681772), 'iterations': 316, 'I6s': (-0.27573088883051455, 0.010244402376083817), 'I2c': (-0.15112457587221584, 0.012756036934883919), 'I1c': (0.5282001115115298, 0.011977412270389065)}
mat1=np.array([
[1.000, -0.073  ,0.126 ,-0.163  ,0.076 , 0.028 ,-0.047,  0.005 ,-0.166, -0.230 ,-0.115],
[-0.073,  1.000 , 0.085 ,-0.209 , 0.028 ,-0.033 ,-0.047, -0.051 ,-0.109, -0.181,  0.106],
[0.126 , 0.085  ,1.000 ,-0.426  ,0.573 , 0.376 ,-0.280 , 0.418 ,-0.733 ,-0.571 , 0.130],
[-0.163, -0.209 ,-0.426 , 1.000 ,-0.158, -0.271 ,-0.017 ,-0.147 , 0.149 , 0.175, -0.209],
[0.076 , 0.028  ,0.573 ,-0.158  ,1.000 , 0.278 ,-0.218  ,0.375 ,-0.663 ,-0.692 , 0.042],
[0.028 ,-0.033  ,0.376 ,-0.271  ,0.278 , 1.000 ,-0.019  ,0.213 ,-0.530 ,-0.522 , 0.053],
[-0.047, -0.047 ,-0.280, -0.017 ,-0.218, -0.019 , 1.000 ,-0.444 , 0.382 ,-0.001, -0.057],
[0.005 ,-0.051  ,0.418 ,-0.147  ,0.375 , 0.213 ,-0.444  ,1.000 ,-0.613 ,-0.398 ,-0.024],
[-0.166, -0.109 ,-0.733 , 0.149 ,-0.663 ,-0.530 , 0.382 ,-0.613 , 1.000 , 0.612 ,-0.139],
[-0.230, -0.181 ,-0.571  ,0.175 ,-0.692 ,-0.522 ,-0.001 ,-0.398 , 0.612 , 1.000, -0.216],
[-0.115 , 0.106 , 0.130 ,-0.209,  0.042  ,0.053, -0.057 ,-0.024, -0.139 ,-0.216,  1.000]
])
0.30935907934479157+/-0.008865064317638819


mat1=np.array([
[1.000 ,-0.016 , 0.232 ,-0.264  ,0.156  ,0.091 ,-0.084  ,0.101 ,-0.278 ,-0.321 ,-0.082],
[-0.016 , 1.000 , 0.140 ,-0.238  ,0.081 , 0.029 ,-0.046 , 0.001 ,-0.179 ,-0.262 , 0.120],
[0.232  ,0.140  ,1.000 ,-0.464 , 0.594  ,0.359 ,-0.304  ,0.499 ,-0.779 ,-0.634  ,0.165],
[-0.264 ,-0.238 ,-0.464 , 1.000 ,-0.219 ,-0.294 , 0.009 ,-0.194 , 0.240 , 0.264 ,-0.236],
[0.156  ,0.081  ,0.594 ,-0.219  ,1.000  ,0.273 ,-0.209  ,0.401 ,-0.681 ,-0.704  ,0.085],
[0.091  ,0.029  ,0.359 ,-0.294  ,0.273  ,1.000 ,-0.038  ,0.222 ,-0.488 ,-0.488  ,0.061],
[-0.084 ,-0.046 ,-0.304 , 0.009 ,-0.209 ,-0.038 , 1.000 ,-0.462 , 0.375 , 0.062 ,-0.051],
[0.101  ,0.001  ,0.499 ,-0.194  ,0.401  ,0.222 ,-0.462  ,1.000 ,-0.666 ,-0.506  ,0.024],
[-0.278 ,-0.179 ,-0.779 , 0.240 ,-0.681 ,-0.488 , 0.375 ,-0.666 , 1.000  ,0.692 ,-0.194],
[-0.321 ,-0.262 ,-0.634 , 0.264 ,-0.704, -0.488 , 0.062 ,-0.506 , 0.692  ,1.000 ,-0.265],
[-0.082 , 0.120 , 0.165 ,-0.236 , 0.085 , 0.061 ,-0.051 , 0.024 ,-0.194 ,-0.265 , 1.000]
  ])
val1={'I9': (0.010263995295352935, 0.005350973348311583), 'I8': (-0.011754472296070184, 0.0060373473568213765), 'I6c': (0.3614222217121217, 0.008161176899539657), 'I3': (-0.09845954868967743, 0.005776104062476584), 'I2s': (0.05670765103207298, 0.005279485599301803), 'I4': (-0.16783011155636052, 0.0072561016401481715), 'I7': (0.011935500489089756, 0.0052912113428275065), 'loglh': -4029.9977472548208, 'status': 3, 'I1s': (0.412175827925634, 0.009199405059256205), 'iterations': 306, 'I6s': (-0.2979606190198347, 0.008263572728998803), 'I2c': (-0.14069115815978162, 0.010680773052595571), 'I1c': (0.5686805099505068, 0.010124586351082598)}

0.29551020331694633+/-0.007045369034067898





mat1=np.array([
[1.000 ,-0.012  ,0.136, -0.236 , 0.059  ,0.040 ,-0.058,  0.020 ,-0.191, -0.255, -0.074],
[-0.012 , 1.000 , 0.159, -0.251,  0.074  ,0.060 ,-0.065,  0.031 ,-0.227, -0.306,  0.130],
[0.136  ,0.159  ,1.000 ,-0.446 , 0.437  ,0.312 ,-0.253 , 0.373 ,-0.667 ,-0.517 , 0.139],
[-0.236 ,-0.251 ,-0.446 , 1.000, -0.138 ,-0.272 ,-0.048 ,-0.091 , 0.145 , 0.235, -0.230],
[0.059  ,0.074  ,0.437 ,-0.138 , 1.000  ,0.208 ,-0.166  ,0.269 ,-0.537 ,-0.584 , 0.051],
[0.040  ,0.060  ,0.312 ,-0.272 , 0.208  ,1.000 ,-0.014  ,0.203 ,-0.491 ,-0.473 , 0.045],
[-0.058 ,-0.065 ,-0.253 ,-0.048, -0.166 ,-0.014 , 1.000 ,-0.452 , 0.385 ,-0.002, -0.067],
[0.020  ,0.031  ,0.373 ,-0.091 , 0.269  ,0.203 ,-0.452  ,1.000 ,-0.620 ,-0.438 , 0.021],
[-0.191 ,-0.227 ,-0.667 , 0.145, -0.537 ,-0.491 , 0.385 ,-0.620 , 1.000 , 0.580, -0.192],
[-0.255 ,-0.306 ,-0.517  ,0.235, -0.584 ,-0.473 ,-0.002 ,-0.438 , 0.580 , 1.000, -0.264],
[-0.074  ,0.130 , 0.139 ,-0.230,  0.051 , 0.045 ,-0.067 , 0.021, -0.192 ,-0.264,  1.000]
  ])
val1={'I9': (-0.0015000416703132569, 0.003799958178849372), 'I8': (-0.0014369477754274662, 0.004226274257997875), 'I6c': (0.35528693230895336, 0.005691715838088696), 'I3': (-0.12192909506471972, 0.0041261719356043836), 'I2s': (0.07346397436063823, 0.003838857074250024), 'I4': (-0.15527945548267685, 0.004285213002518828), 'I7': (-0.00832868722723279, 0.003929797312726857), 'loglh': -7762.36571730626, 'status': 3, 'I1s': (0.43200203207004506, 0.005798214334668095), 'iterations': 345, 'I6s': (-0.2770943924458865, 0.005241665008245078), 'I2c': (-0.17623395432961297, 0.007057510651538257), 'I1c': (0.5789882597289371, 0.006320256349031994)}
0.30206137552729573+/-0.004734412589163087
############


#10
mat1=np.array([
[1.000 , 0.028  ,0.163 ,-0.246  ,0.100,  0.087 ,-0.088 , 0.067 ,-0.224, -0.270 ,-0.059],
[0.028  ,1.000  ,0.185 ,-0.288  ,0.106 , 0.089 ,-0.098 , 0.087 ,-0.253 ,-0.317 , 0.160],
[0.163  ,0.185  ,1.000 ,-0.472  ,0.558 , 0.388 ,-0.321 , 0.488 ,-0.732 ,-0.621 , 0.186],
[-0.246 ,-0.288 ,-0.472,  1.000 ,-0.194, -0.320, -0.017, -0.135,  0.217,  0.305, -0.267],
[0.100  ,0.106  ,0.558 ,-0.194  ,1.000 , 0.322 ,-0.264 , 0.405 ,-0.650 ,-0.694 , 0.120],
[0.087  ,0.089  ,0.388 ,-0.320  ,0.322 , 1.000 ,-0.078 , 0.310 ,-0.563 ,-0.533 , 0.098],
[-0.088 ,-0.098 ,-0.321, -0.017 ,-0.264, -0.078 , 1.000, -0.495,  0.453,  0.137, -0.086],
[0.067  ,0.087  ,0.488 ,-0.135  ,0.405 , 0.310 ,-0.495 , 1.000 ,-0.714 ,-0.594 , 0.082],
[-0.224 ,-0.253 ,-0.732 , 0.217 ,-0.650, -0.563 , 0.453, -0.714 , 1.000,  0.705, -0.245],
[-0.270 ,-0.317 ,-0.621 , 0.305 ,-0.694, -0.533 , 0.137, -0.594 , 0.705,  1.000, -0.300],
[-0.059 , 0.160 , 0.186 ,-0.267 , 0.120 , 0.098 ,-0.086,  0.082 ,-0.245 ,-0.300,  1.000]
  ])
val1={'I9': (-0.00814709992730056, 0.01132542716609497), 'I8': (-0.002742301882335263, 0.012296373987281783), 'I6c': (0.37719377630188333, 0.016598578093436678), 'I3': (-0.13792415903134558, 0.012495506148421986), 'I2s': (0.08054607258467072, 0.011463341968429575), 'I4': (-0.16448986378061747, 0.015080562954984333), 'I7': (-0.0012097312571406338, 0.011623007447657818), 'loglh': -1022.7153540096336, 'status': 3, 'I1s': (0.4415270868124068, 0.019845592983503635), 'iterations': 314, 'I6s': (-0.28339850411168865, 0.01668306762054611), 'I2c': (-0.21347216249250955, 0.02388957630041566), 'I1c': (0.5989786923791036, 0.02202756076010859)}

0.313138194404873+/-0.015256926037561942



#50
mat1=np.array([
[1.000 ,-0.014  ,0.120 ,-0.229 , 0.048 , 0.031 ,-0.059 , 0.006 ,-0.173 ,-0.240 ,-0.076],
[-0.014 , 1.000 , 0.158 ,-0.249,  0.067 , 0.063 ,-0.067 , 0.025, -0.226 ,-0.303 , 0.134],
[0.120  ,0.158  ,1.000 ,-0.439 , 0.430  ,0.322 ,-0.252  ,0.361 ,-0.662 ,-0.510  ,0.139],
[-0.229 ,-0.249 ,-0.439 , 1.000, -0.143 ,-0.271 ,-0.054 ,-0.082 , 0.137 , 0.233 ,-0.230],
[0.048  ,0.067  ,0.430 ,-0.143 , 1.000  ,0.215 ,-0.164  ,0.258 ,-0.532 ,-0.578 , 0.062],
[0.031  ,0.063  ,0.322 ,-0.271 , 0.215  ,1.000 ,-0.010  ,0.212 ,-0.510 ,-0.483 , 0.048],
[-0.059 ,-0.067 ,-0.252 ,-0.054, -0.164 ,-0.010 , 1.000 ,-0.447 , 0.379 ,-0.008, -0.055],
[0.006  ,0.025  ,0.361 ,-0.082 , 0.258  ,0.212 ,-0.447  ,1.000 ,-0.609 ,-0.426 , 0.020],
[-0.173 ,-0.226 ,-0.662  ,0.137, -0.532 ,-0.510 , 0.379 ,-0.609 , 1.000 , 0.573, -0.201],
[-0.240 ,-0.303 ,-0.510 , 0.233, -0.578 ,-0.483 ,-0.008 ,-0.426 , 0.573 , 1.000, -0.274],
[-0.076  ,0.134 , 0.139 ,-0.230,  0.062 , 0.048, -0.055 , 0.020 ,-0.201 ,-0.274,  1.000]
  ])
val1={'I9': (-0.003745643667496079, 0.004682334198264748), 'I8': (0.007556483308194251, 0.005173597565039212), 'I6c': (0.35131734634074974, 0.006941975254580179), 'I3': (-0.13253298893439258, 0.005125590041137662), 'I2s': (0.07347960766841011, 0.004737530913559107), 'I4': (-0.14963725087613966, 0.005275477334423684), 'I7': (-0.005360262896074497, 0.004827670732682365), 'loglh': -5019.565470251959, 'status': 3, 'I1s': (0.43213787498486145, 0.007107996627978452), 'iterations': 325, 'I6s': (-0.2717686652479411, 0.006410894195621797), 'I2c': (-0.1682210938024158, 0.008540549553877008), 'I1c': (0.5669908594793718, 0.0076803878895355115)}

0.29978373364287225+/-0.005792822023427245




#100

mat1=np.array([
[1.000, -0.009 , 0.108, -0.226  ,0.035  ,0.028 ,-0.054, -0.003 ,-0.167 ,-0.235 ,-0.076],
[-0.009,  1.000 , 0.162, -0.251 , 0.074 , 0.070, -0.067,  0.040 ,-0.250 ,-0.334,  0.147],
[0.108 , 0.162  ,1.000 ,-0.426  ,0.385  ,0.289 ,-0.231 , 0.319 ,-0.610 ,-0.466 , 0.132],
[-0.226, -0.251 ,-0.426 , 1.000 ,-0.109 ,-0.252, -0.066 ,-0.058 , 0.098 , 0.201, -0.227],
[0.035  ,0.074  ,0.385 ,-0.109  ,1.000  ,0.193 ,-0.153  ,0.230 ,-0.502 ,-0.553  ,0.048],
[0.028  ,0.070  ,0.289 ,-0.252  ,0.193  ,1.000 , 0.001  ,0.191 ,-0.497 ,-0.469  ,0.050],
[-0.054 ,-0.067 ,-0.231, -0.066 ,-0.153 , 0.001,  1.000 ,-0.447 , 0.377 ,-0.026 ,-0.058],
[-0.003 , 0.040 , 0.319, -0.058 , 0.230 , 0.191, -0.447 , 1.000 ,-0.597 ,-0.401 , 0.013],
[-0.167 ,-0.250 ,-0.610 , 0.098 ,-0.502 ,-0.497,  0.377 ,-0.597 , 1.000 , 0.548 ,-0.196],
[-0.235 ,-0.334 ,-0.466 , 0.201 ,-0.553 ,-0.469, -0.026 ,-0.401 , 0.548 , 1.000 ,-0.272],
[-0.076 , 0.147 , 0.132 ,-0.227  ,0.048 , 0.050, -0.058 , 0.013 ,-0.196 ,-0.272,  1.000]
  ])
val1={'I9': (-0.004477102143375822, 0.003290690237316707), 'I8': (0.005229369243670012, 0.0036535390204492924), 'I6c': (0.34973028648985016, 0.004914455773518234), 'I3': (-0.13271923464372148, 0.0035822600567028684), 'I2s': (0.07381979235387215, 0.0033344666352281838), 'I4': (-0.14808607411747432, 0.003641056673956866), 'I7': (-0.008525871499317716, 0.003501840150362312), 'loglh': -9974.97100866043, 'status': 3, 'I1s': (0.42782836002680713, 0.004808562528755278), 'iterations': 352, 'I6s': (-0.26580720868064867, 0.004220700414780787), 'I2c': (-0.16833413377272832, 0.005975063754886933), 'I1c': (0.5718488033361477, 0.005352977428305872)}

0.2994930134069189+/-0.004035440450311477







val1={'I9': (-0.007118521187692406, 0.011120081139119498), 'I8': (-0.0017087400384069307, 0.01209830698651565), 'I6c': (0.3765837821470237, 0.015935007118138667), 'I3': (-0.13574109721497185, 0.011959750142757686), 'I2s': (0.08052038621568358, 0.010996740098557556), 'I4': (-0.15868442169063723, 0.012577200782152409), 'I7': (-0.0003058805693286759, 0.011430990452425516), 'loglh': -1025.1574356106112, 'status': 3, 'I1s': (0.43593544129448625, 0.016883905144163935), 'iterations': 326, 'I6s': (-0.27920162786503, 0.015173766039955017), 'I2c': (-0.21119824816648158, 0.020573484785378515), 'I1c': (0.5911335583927657, 0.01878617485702294)}
i9=result['I9'][0]
i8=result['I8'][0]
i7=result['I7'][0]
i6s=result['I6s'][0]
i6c=result['I6c'][0]
i5=result['I5'][0]
i4=result['I4'][0]
i3=result['I3'][0]
i2s=result['I2s'][0]
i2c=result['I2c'][0]
i1s=result['I1s'][0]
i1c=result['I1c'][0]


(I8,I7,I6s,I6c,I4,I3,I2s,I2c,I1s,I1c,I9)= correlated_values([I8,I7,I6s,I6c,I4,I3,I2s,I2c,I1s,I1c,I9],covmat)

